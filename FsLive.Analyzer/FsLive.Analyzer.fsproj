<Project>
  <!-- See https://stackoverflow.com/questions/43921992/how-can-i-use-beforebuild-and-afterbuild-targets-with-visual-studio-2017 -->
  <Import Project="Sdk.props" Sdk="Microsoft.NET.Sdk" />
  
  <PropertyGroup>
    <TargetFramework>netstandard2.0</TargetFramework>
  </PropertyGroup>

  <ItemGroup>
    <None Remove="C:\Users\Administrator\.nuget\packages\fsharp.core\5.0.2-dev\contentFiles\any\netstandard2.0\FSharp.Core.xml" />
  </ItemGroup>

  <ItemGroup>
    <Compile Include="Analyzer.fs" />
    
    <!-- lay down the analyzer DLL in the tools/fsharp41 directory of the package, i.e. a compiler tool -->
    <TfmSpecificPackageFile Include="bin\$(Configuration)\$(TargetFramework)\FsLive.Analyzer.dll">
      <PackagePath>tools/fsharp41/$(TargetFramework)/FsLive.Analyzer.dll</PackagePath>
    </TfmSpecificPackageFile>
    <!-- lay down the fslive EXE in the tools/fslive directory of the package, i.e. a subsidiary tool -->
    <ExeToolFiles Include="..\FsLive.Cli\bin\$(Configuration)\netcoreapp3.1\**\*.*" />
    <TfmSpecificPackageFile Include="@(ExeToolFiles)">
      <PackagePath>tools/fslive/netcoreapp3.1/%(RecursiveDir)%(Filename)%(Extension)</PackagePath>
    </TfmSpecificPackageFile>
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="FSharp.Compiler.Service" Version="39.0.3-dev" />
    <ProjectReference Include="..\src\FSharp.Compiler.PortaCode.fsproj" />
    <PackageReference Update="FSharp.Core" Version="5.0.2-dev" />
  </ItemGroup>

  <Import Project="Sdk.targets" Sdk="Microsoft.NET.Sdk" />

  <!-- For testing purposes we place the fslive EXE in well-known locations with respect to the analyzer DLL -->
  <Target Name="AfterBuild">
    <Copy
        SourceFiles="@(ExeToolFiles)"
        DestinationFiles="@(ExeToolFiles->'bin\fslive\netcoreapp3.1\%(RecursiveDir)%(Filename)%(Extension)')" />
  </Target>

</Project>
